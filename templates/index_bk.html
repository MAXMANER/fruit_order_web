<!doctype html>
<html lang="en" data-bs-theme="auto">
  <head>
    <script src="{{url_for('static',filename='assets/js/color-modes.js')}}"></script>

    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="">
    <meta name="author" content="Mark Otto, Jacob Thornton, and Bootstrap contributors">
    <meta name="generator" content="Hugo 0.122.0">
    <title>老朱果園訂購</title>

    

    <link rel="stylesheet" href="{{ url_for('static', filename='bootstrap/css/bootstrap.min.css') }}">
<script src="{{ url_for('static', filename='jquery-3.7.1.min.js') }}" type="text/javascript"></script>
<script src="{{ url_for('static', filename='bootstrap/js/bootstrap.bundle.min.js') }}"></script>
<link href="{{url_for('static',filename='assets/dist/css/bootstrap.min.css')}}" rel="stylesheet">

    <style>
      .bd-placeholder-img {
        font-size: 1.125rem;
        text-anchor: middle;
        -webkit-user-select: none;
        -moz-user-select: none;
        user-select: none;
      }

      @media (min-width: 768px) {
        .bd-placeholder-img-lg {
          font-size: 3.5rem;
        }
      }

      .b-example-divider {
        width: 100%;
        height: 3rem;
        background-color: rgba(0, 0, 0, .1);
        border: solid rgba(0, 0, 0, .15);
        border-width: 1px 0;
        box-shadow: inset 0 .5em 1.5em rgba(0, 0, 0, .1), inset 0 .125em .5em rgba(0, 0, 0, .15);
      }

      .b-example-vr {
        flex-shrink: 0;
        width: 1.5rem;
        height: 100vh;
      }

      .bi {
        vertical-align: -.125em;
        fill: currentColor;
      }

      .nav-scroller {
        position: relative;
        z-index: 2;
        height: 2.75rem;
        overflow-y: hidden;
      }

      .nav-scroller .nav {
        display: flex;
        flex-wrap: nowrap;
        padding-bottom: 1rem;
        margin-top: -1px;
        overflow-x: auto;
        text-align: center;
        white-space: nowrap;
        -webkit-overflow-scrolling: touch;
      }

      .btn-bd-primary {
        --bd-violet-bg: #712cf9;
        --bd-violet-rgb: 112.520718, 44.062154, 249.437846;

        --bs-btn-font-weight: 600;
        --bs-btn-color: var(--bs-white);
        --bs-btn-bg: var(--bd-violet-bg);
        --bs-btn-border-color: var(--bd-violet-bg);
        --bs-btn-hover-color: var(--bs-white);
        --bs-btn-hover-bg: #6528e0;
        --bs-btn-hover-border-color: #6528e0;
        --bs-btn-focus-shadow-rgb: var(--bd-violet-rgb);
        --bs-btn-active-color: var(--bs-btn-hover-color);
        --bs-btn-active-bg: #5a23c8;
        --bs-btn-active-border-color: #5a23c8;
      }

      .bd-mode-toggle {
        z-index: 1500;
      }

      .bd-mode-toggle .dropdown-menu .active .bi {
        display: block !important;
      }
      
    </style>

    
    <!-- Custom styles for this template -->
    <link href="{{url_for('static',filename='checkout.css')}}" rel="stylesheet">
  </head>
  <body class="bg-body-tertiary">
    <svg xmlns="http://www.w3.org/2000/svg" class="d-none">

<div class="container">
  <main>
    <div class="py-5 text-center">
      <img class="d-block mx-auto mb-4" src="{{url_for('static',filename='assets/brand/bootstrap-logo.svg')}}" alt="" width="72" height="57">
      <h2>訂購明細</h2>
      <p class="lead">尊敬的 {{user_name}} 先生/女士您好，若是送禮需求留下您的姓名、電話，方便收禮人確認.</p>
    </div>
 
    <div class="row g-5">
      <div class="col-md-5 col-lg-4 order-md-last">
        <h4 class="d-flex justify-content-between align-items-center mb-3">
          <span class="text-primary">購物車</span>
          <span id="total-quantity"class="badge bg-primary rounded-pill">0</span>
        </h4>
        <ul class="list-group mb-3">
          <li class="list-group-item d-flex justify-content-between lh-sm">
            <div>
              <h6 class="my-0">特級文旦</h6>
              <small class="text-body-secondary">Brief description</small>
            </div>
            <span>$<span class="text-body-secondary" id="item1-price">0</span></span>
          </li>
          <li class="list-group-item d-flex justify-content-between lh-sm">
            <div>
              <h6 class="my-0">優級文旦</h6>
              <small class="text-body-secondary">Brief description</small>
            </div>
            <span>$<span class="text-body-secondary" id="item2-price">0</span></span>
          </li>
          <li class="list-group-item d-flex justify-content-between bg-body-tertiary">
            <div class="text-success">
              <h6 class="my-0">優惠</h6>
              <small>第一年特惠</small>
            </div>
            <span>−$<span class="text-success" id="discount">0</span></span>
          </li>
          <li class="list-group-item d-flex justify-content-between">
            <span>Total (TW)</span>
            <span>$<strong id="total">0</strong></span>
          </li>
        </ul>

        <form class="card p-2">
          <div class="input-group">
            <input type="text" class="form-control" placeholder="付款碼">
            <button type="submit" class="btn btn-secondary">修改</button>
          </div>
        </form>
      </div>
      <div class="col-md-7 col-lg-8">
        <h4 class="mb-3">訂單訊息</h4>
        <form id="dataForm" class="needs-validation" novalidate>
          <div class="row g-3">
            <table class="shop_table" cellspacing="0">    
              <tbody><tr class="product-item ">
      
                  <td class="product-thumbnail">
                      <a href="https://www.acfresh.com.tw/wp-content/uploads/2019/09/product002.jpg" data-rel="prettyPhoto" itemprop="image" class="woocommerce-main-image zoom">
                          <img width="100" height="100" src="https://www.acfresh.com.tw/wp-content/uploads/2019/09/product002-300x300.jpg" class="attachment-woocommerce_thumbnail size-woocommerce_thumbnail" alt="" srcset="https://www.acfresh.com.tw/wp-content/uploads/2019/09/product002-300x300.jpg 300w, https://www.acfresh.com.tw/wp-content/uploads/2019/09/product002-150x150.jpg 150w, https://www.acfresh.com.tw/wp-content/uploads/2019/09/product002-768x768.jpg 768w, https://www.acfresh.com.tw/wp-content/uploads/2019/09/product002-600x600.jpg 600w, https://www.acfresh.com.tw/wp-content/uploads/2019/09/product002-100x100.jpg 100w, https://www.acfresh.com.tw/wp-content/uploads/2019/09/product002.jpg 800w" sizes="(max-width: 300px) 100vw, 300px">                </a>
                  </td>
      
                  <td class="product-name">特級文旦柚(十斤/13~16入)</td>
      
                  <td class="product-price">
                      <span itemprop="price" class="price"><del><span class="woocommerce-Price-amount amount"><span class="woocommerce-Price-currencySymbol">NT$</span>800</span></del> <ins><span class="woocommerce-Price-amount amount"><span class="woocommerce-Price-currencySymbol">NT$</span>760</span></ins></span>
                  </td>
      
                  <td class="product-quantity">
      <div class="input-group">
                <span class="input-group-btn">
                    <button type="button" class="btn btn-danger btn-number"  data-type="minus" data-field="item1_quantity">-</button>
                </span>
                <input type="text" id="item1_quantity" name="item1_quantity" class="form-control input-number" value="0" min="0" max="100">
                <span class="input-group-btn">
                    <button type="button" class="btn btn-success btn-number" data-type="plus" data-field="item1_quantity">+</button>
                </span>
            </div>
                  </td>
              </tr>
          
              <tr class="product-item ">
      
                  <td class="product-thumbnail">
                      <a href="https://www.acfresh.com.tw/wp-content/uploads/2019/09/product003.jpg" data-rel="prettyPhoto" itemprop="image" class="woocommerce-main-image zoom">
                          <img width="100" height="100" src="https://www.acfresh.com.tw/wp-content/uploads/2019/09/product003-300x300.jpg" class="attachment-woocommerce_thumbnail size-woocommerce_thumbnail" alt="" srcset="https://www.acfresh.com.tw/wp-content/uploads/2019/09/product003-300x300.jpg 300w, https://www.acfresh.com.tw/wp-content/uploads/2019/09/product003-150x150.jpg 150w, https://www.acfresh.com.tw/wp-content/uploads/2019/09/product003-768x768.jpg 768w, https://www.acfresh.com.tw/wp-content/uploads/2019/09/product003-600x600.jpg 600w, https://www.acfresh.com.tw/wp-content/uploads/2019/09/product003-100x100.jpg 100w, https://www.acfresh.com.tw/wp-content/uploads/2019/09/product003.jpg 800w" sizes="(max-width: 300px) 100vw, 300px">                </a>
                  </td>
      
                  <td class="product-name">優級文旦(十斤/10~12入)</td>
      
                  <td class="product-price">
                      <span itemprop="price" class="price"><del><span class="woocommerce-Price-amount amount"><span class="woocommerce-Price-currencySymbol">NT$</span>600</span></del> <ins><span class="woocommerce-Price-amount amount"><span class="woocommerce-Price-currencySymbol">NT$</span>570</span></ins></span>
                  </td>
      
                  <td class="product-quantity">
                       <div class="input-group">
                <span class="input-group-btn">
                    <button type="button" class="btn btn-danger btn-number"  data-type="minus" data-field="item2_quantity">-</button>
                </span>
                <input type="text" id="item2_quantity"name="item2_quantity" class="form-control input-number" value="0" min="0" max="100">
                <span class="input-group-btn">
                    <button type="button" class="btn btn-success btn-number" data-type="plus" data-field="item2_quantity">+</button>
                </span>
            </div>
                  </td>
              </tr>
          </tbody></table>

            <div class="col-sm-6">
              <label for="receiverName" class="form-label">收件人姓名</label>
              <input type="text" class="form-control" id="receiverName" name ="recipient_name" placeholder="" value="{{user_name}}" required>
              <div class="invalid-feedback">
                請填寫收件人姓名.
              </div>
            </div>

            <div class="col-sm-7">
              <label for="receiverPhone" class="form-label">收件人聯絡電話</label>
              <input type="text" class="form-control" id="receiverPhone" name="recipient_phone" placeholder="" required>
              <div class="invalid-feedback">
                請填寫收件人姓名.
              </div>
            </div>

            <div class="col-12">
              <label for="receiveraddress" class="form-label">收件人地址</label>
              <input type="text" class="form-control" id="receiveraddress" name="recipient_address" placeholder="" required>
              <div class="invalid-feedback">
                請輸入收件人地址.
              </div>
            </div>
        
          <hr class="my-4">


          <div class="col-sm-6">
            <label for="senderName" class="form-label">寄件人姓名</label>
            <input type="text" class="form-control" id="senderName" name="sender_name" placeholder="" value="" >
            <div class="invalid-feedback">
              請填寫送禮人姓名.
            </div>
          </div>

          <div class="col-sm-7">
            <label for="senderPhone" class="form-label">寄件人聯絡電話</label>
            <input type="text" class="form-control" id="senderPhone" name="sender_phone" placeholder="" value="" >
            <div class="invalid-feedback">
              請填寫送禮人電話.
            </div>
          </div>

          <button class="w-100 btn btn-primary btn-lg" type="submit">送出訂單</button>
        </form>
      </div>
    </div>
  </main>

  <script src="{{url_for('static',filename='assets/dist/js/bootstrap.bundle.min.js')}}"></script>

<script>
  $(document).ready(function() {
        function updateTotal() {
            var item1_quantity = parseFloat($('#item1_quantity').val());
            var item2_quantity = parseFloat($('#item2_quantity').val());

            if (!isNaN(item1_quantity) && !isNaN(item2_quantity)) {
                $('#item1-price').text(item1_quantity * 760);
                $('#item2-price').text(item2_quantity * 570);
                var total_quantity = item1_quantity + item2_quantity;
                var total_price = (item1_quantity * 760) + (item2_quantity * 570);
                $('#total-quantity').text(total_quantity);
                $('#total').text(total_price);
                var discount = (item1_quantity * 40) + (item2_quantity * 30);
                $('#discount').text(discount);
            } else {
                $('#total').text('Invalid input');
            }
        }

        $('#item1_quantity, #item2_quantity').on('input', updateTotal);

    $('.btn-number').click(function(e){
    e.preventDefault();
    
    fieldName = $(this).attr('data-field');
    type      = $(this).attr('data-type');
    var input = $("input[name='"+fieldName+"']");
    var currentVal = parseInt(input.val());
    if (!isNaN(currentVal)) {
        if(type == 'minus') {
            
            if(currentVal > input.attr('min')) {
                input.val(currentVal - 1).change();
            } 
            if(parseInt(input.val()) == input.attr('min')) {
                $(this).attr('disabled', true);
            }

        } else if(type == 'plus') {

            if(currentVal < input.attr('max')) {
                input.val(currentVal + 1).change();
            }
            if(parseInt(input.val()) == input.attr('max')) {
                $(this).attr('disabled', true);
            }

        }
    } else {
        input.val(0);
    }
    updateTotal();
});
$('.input-number').focusin(function(){
   $(this).data('oldValue', $(this).val());
});
$('.input-number').change(function() {
    
    minValue =  parseInt($(this).attr('min'));
    maxValue =  parseInt($(this).attr('max'));
    valueCurrent = parseInt($(this).val());
    
    name = $(this).attr('name');
    if(valueCurrent >= minValue) {
        $(".btn-number[data-type='minus'][data-field='"+name+"']").removeAttr('disabled')
    } else {
        alert('Sorry, the minimum value was reached');
        $(this).val($(this).data('oldValue'));
    }
    if(valueCurrent <= maxValue) {
        $(".btn-number[data-type='plus'][data-field='"+name+"']").removeAttr('disabled')
    } else {
        alert('Sorry, the maximum value was reached');
        $(this).val($(this).data('oldValue'));
    }
    
    
});
$(".input-number").keydown(function (e) {
        // Allow: backspace, delete, tab, escape, enter and .
        if ($.inArray(e.keyCode, [46, 8, 9, 27, 13, 190]) !== -1 ||
             // Allow: Ctrl+A
            (e.keyCode == 65 && e.ctrlKey === true) || 
             // Allow: home, end, left, right
            (e.keyCode >= 35 && e.keyCode <= 39)) {
                 // let it happen, don't do anything
                 return;
        }
        // Ensure that it is a number and stop the keypress
        if ((e.shiftKey || (e.keyCode < 48 || e.keyCode > 57)) && (e.keyCode < 96 || e.keyCode > 105)) {
            e.preventDefault();
        }
    });
            $('#dataForm').on('submit', function(event) {
                event.preventDefault(); // Prevent the default form submission

                // Serialize the form data
                var formData = $(this).serialize();
                var data = $(this).serialize() + "&purchaser_id={{user_id}}&purchaser_name={{user_name}}"
                var item1_quantity = parseFloat($('#item1_quantity').val());
                var item2_quantity = parseFloat($('#item2_quantity').val());
                // Send an AJAX request to the server-side script
                $.ajax({
                    type: 'POST',
                    url: 'https://fc57-2001-b011-800b-10fc-fccd-eb99-80b-947c.ngrok-free.app/save_data', // Change to your server-side script
                    data: data,
                    success: function(response) {
                        alert('Data saved successfully: ' + response);
                    },
                    error: function(jqXHR, textStatus, errorThrown) {
                        alert('Error saving data: ' + textStatus);
                    }
                });
            });
        });

  </script>
    <script src="{{url_for('static',filename='checkout.js')}}"></script></body>
</html>
